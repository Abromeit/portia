{{#tree-list-item model=item hasChildren=item.annotations.length onMouseEnter=(action 'enterItem' item) onMouseLeave=(action 'leaveItem' item) as |item-item|}}
    {{#if (eq item-item.section "item")}}
        {{yield item-item}}
    {{else if (eq item-item.section "subtrees")}}
        {{#each item.annotations as |annotation|}}
            {{#if (eq annotation.constructor.modelName "annotation")}}
                {{#item-item.subtree.item model=annotation onMouseEnter=(action 'enterAnnotation' annotation) onMouseLeave=(action 'leaveAnnotation' item) as |annotation-item|}}
                    {{#annotation-item.link 'projects.project.spider.sample.data.annotation' annotation}}
                        {{annotation-item.icon icon=annotation.type}}
                        {{annotation-item.badge value=(or annotation.elements.length 0) color=(array-get annotationColors annotation.orderedIndex)}}
                        {{annotation-item.annotation-field selecting=(mut annotation.new)}}
                        {{#annotation-item.field-type field=annotation.field}}
                            Change type of selected field
                        {{/annotation-item.field-type}}
                        {{#annotation-item.link 'projects.project.spider.sample.data.annotation.options' annotation bubbles=false class="ignore-active"}}
                            {{annotation-item.icon icon='options'}}
                        {{/annotation-item.link}}
                        {{annotation-item.icon icon='remove' action=(action 'removeAnnotation' annotation) bubbles=false}}
                    {{/annotation-item.link}}
                {{/item-item.subtree.item}}
            {{else if (eq annotation.constructor.modelName "item-annotation")}}
                {{#item-item.subtree.annotations-item sample=sample item=annotation.item annotationColors=annotationColors as |nested-item|}}
                    {{#nested-item.link 'projects.project.spider.sample.data.item' annotation.item}}
                        {{nested-item.icon icon='schema'}}
                        {{nested-item.badge value=(or annotation.elements.length 0)}}
                        {{nested-item.editable value=(mut annotation.name) editing=(mut annotation.new) onChange=(action 'saveItemAnnotation' annotation)}}
                        {{nested-item.item-schema item=annotation.item.content}}
                        {{nested-item.add-annotation-menu}}
                        {{nested-item.icon icon='remove' action=(action 'removeItemAnnotation' annotation) bubbles=false}}
                    {{/nested-item.link}}
                {{/item-item.subtree.annotations-item}}
            {{/if}}
        {{/each}}
    {{/if}}
{{/tree-list-item}}
